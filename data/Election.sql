CREATE TABLE IF NOT EXISTS tweets(
    ID SERIAL PRIMARY KEY,
    autor VARCHAR(50) NOT NULL,
    message VARCHAR(512) NOT NULL,
    created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS popularity(
    tweetID INTEGER PRIMARY KEY,
    favorites INTEGER NOT NULL DEFAULT 0,
    retweets INTEGER NOT NULL DEFAULT 0
);

CREATE TABLE IF NOT EXISTS hashtags(
    ID SERIAL PRIMARY KEY,
    tagName VARCHAR(50) NOT NULL,
    created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    UNIQUE (tagName)
);

CREATE TABLE IF NOT EXISTS hathashtags(
    tweetID INTEGER NOT NULL,
    tagID INTEGER NOT NULL,
    popularity INTEGER NOT NULL DEFAULT 1,
    PRIMARY KEY (tweetID,tagID)
);

CREATE TABLE IF NOT EXISTS inverbmit(
    hash1 INTEGER NOT NULL,
    hash2 INTEGER NOT NULL,
    popularity INTEGER NOT NULL DEFAULT 1,
    PRIMARY KEY (hash1,hash2)
);

-- FOREIGN KEYS
ALTER TABLE popularity ADD CONSTRAINT popfk FOREIGN KEY (tweetID) REFERENCES tweets(ID);

ALTER TABLE hathashtags 
    ADD CONSTRAINT hashfk1 FOREIGN KEY (tweetID) REFERENCES tweets(ID),
    ADD CONSTRAINT hashfk2 FOREIGN KEY (tagID) REFERENCES hashtags(ID);

ALTER TABLE inverbmit
    ADD CONSTRAINT verbfk1 FOREIGN KEY (hash1) REFERENCES hashtags(ID),
    ADD CONSTRAINT verbfk2 FOREIGN KEY (hash2) REFERENCES hashtags(ID);